{"version":3,"names":[],"mappings":"","sources":["touchbar.js"],"sourcesContent":["'use strict'\n\n\nconst { TouchBar, app, ipcMain } = require('electron')\nconst path\t\t\t\t= require( 'path' )\nconst nativeImage\t\t= require('electron').nativeImage\nconst Store\t\t\t\t= require( 'electron-store' )\nconst store\t\t\t\t= new Store()\nconst log\t\t\t\t= require( 'electron-log' )\n\nconst {\n\t\n\tTouchBarButton,\n\tTouchBarSpacer,\n\tTouchBarPopover,\n\tTouchBarSlider,\n\tTouchBarLabel,\n\tTouchBarSegmentedControl\n\n} = TouchBar\n\nlet previewBar,\n\teditBar,\n\tformatBar,\n\tprefsBar,\n\ttextSlider,\n\tthemeSelect\n\nconst themeVals\t= ['default', 'light', 'dark']\n\nmodule.exports = {\n\t\n\tcreateTouchbar: function( window, state ) {\n\t\t\n\t\tconst i18n = require( './i18n.min' )\n\t\t\n\t\tpreviewBar = new TouchBar({\n\t\t\t\n\t\t\tescapeItem: new TouchBarButton({\n\t\t\t\t\n\t\t\t\taccessibilityLabel: i18n.t('touchbar:preview.edit', 'Edit'),\n\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/edit_2x.png') ),\n\t\t\t\tclick: () => { window.webContents.send( 'note', 'edit' ) }\n\t\t\t}),\n\t\t\t\n\t\t\titems: [\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:preview.new', 'New'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/new_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send( 'note', 'new' ) }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:preview.favorite', 'Favorite'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/favorite_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send( 'note', 'favorite' ) }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:preview.delete', 'Delete'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/delete_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send( 'note', 'delete' ) }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarSpacer({ size: 'small' }),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:preview.export', 'Export'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/export_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send( 'note', 'export' ) }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:preview.print', 'Print'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/print_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send( 'note', 'print' ) }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarSpacer({ size: 'small' }),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:preview.search', 'Search'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/search_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send( 'note', 'find' ) }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:preview.categories', 'Categories'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/categories_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send( 'toggle-categories', '' ) }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarSpacer({ size: 'small' }),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:preview.prefercences', 'Preferences'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/preferences_2x.png') ),\n\t\t\t\t\tclick: () => { app.emit('open-prefs') }\n\t\t\t\t})\n\t\t\t]\n\t\t})\n\t\t\n\t\tformatBar = new TouchBar({\n\t\t\t\n\t\t\titems: [\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:format.heading', 'Heading'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/heading_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send('markdown', 'heading') }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:format.bold', 'Bold'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/bold_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send('markdown', 'b') }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:format.italic', 'Italic'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/italic_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send('markdown', 'i') }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:format.ul', 'List'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/ul_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send('markdown', 'ul') }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:format.check', 'Checkbox List'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/checkbox_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send('markdown', 'cl') }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:format.link', 'Link'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/link_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send('markdown', 'a') }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:format.image', 'Image'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/image_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send('markdown', 'img') }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:format.code', 'Code'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/code_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send('markdown', 'code') }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:format.table', 'Table'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/table_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send('markdown', 'table') }\n\t\t\t\t})\n\t\t\t]\n\t\t})\n\t\t\n\t\teditBar = new TouchBar({\n\t\t\t\n\t\t\tescapeItem: new TouchBarButton({\n\t\t\t\t\n\t\t\t\taccessibilityLabel: i18n.t('touchbar:edit.preview', 'Preview'),\n\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/preview_2x.png') ),\n\t\t\t\tclick: () => { window.webContents.send( 'note', 'edit' ) }\n\t\t\t}),\n\t\t\t\n\t\t\titems: [\n\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:edit.save', 'Save'),\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/save_2x.png') ),\n\t\t\t\t\tclick: () => { window.webContents.send( 'note', 'save' ) }\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tnew TouchBarPopover({\n\t\t\t\t\t\n\t\t\t\t\ticon: nativeImage.createFromPath( path.join(__dirname, '../assets/png/format_2x.png') ),\n\t\t\t\t\tshowCloseButton: true,\n\t\t\t\t\titems: formatBar\n\t\t\t\t})\n\t\t\t]\n\t\t})\n\t\t\n\t\tmodule.exports.switchTouchbar( window, state )\n\t},\n\t\n\tswitchTouchbar: function( window, state ) {\n\t\t\n\t\tif( state ) {\n\t\t\t\n\t\t\twindow.setTouchBar( editBar )\n\t\t\n\t\t} else {\n\t\t\t\n\t\t\twindow.setTouchBar( previewBar )\n\t\t}\n\t},\n\t\n\tprefsTouchbar: function( window ) {\n\t\t\n\t\tconst i18n\t\t= require( './i18n.min' )\n\t\tconst theme\t\t= store.get( 'appInterface.theme' )\n\t\tlet currentTheme = themeVals.indexOf( theme ),\n\t\t\tsize = store.get( 'appSettings.zoom' )\n\t\t\t\n\t\ttextSlider = new TouchBarSlider({\n\t\t\t\n\t\t\tlabel: i18n.t('touchbar:prefs.textsize', 'Text size'),\n\t\t\tvalue: parseInt( size ),\n\t\t\tminValue: 4,\n\t\t\tmaxValue: 16,\n\t\t\tchange: ( newValue ) => {\n\t\t\t\t\n\t\t\t\twindow.webContents.send( 'touchbar-zoom', newValue )\n\t\t\t}\n\t\t})\n\t\t\n\t\tthemeSelect = new TouchBarSegmentedControl({\n\t\t\t\n\t\t\tsegments: [\n\t\t\t\t{ label: i18n.t('touchbar:prefs.os', 'OS Default') },\n\t\t\t\t{ label: i18n.t('touchbar:prefs.light', 'Light') },\n\t\t\t\t{ label: i18n.t('touchbar:prefs.dark', 'Dark') }\n\t\t\t],\n\t\t\tselectedIndex: currentTheme,\n\t\t\tchange: ( selectedIndex ) => {\n\t\t\t\t\n\t\t\t\twindow.webContents.send( 'touchbar-theme', themeVals[selectedIndex] )\n\t\t\t}\n\t\t})\n\t\t\n\t\tprefsBar = new TouchBar({\n\t\t\t\n\t\t\titems: [\n\t\t\t\t\n\t\t\t\ttextSlider,\n\t\t\t\t\n\t\t\t\tnew TouchBarSpacer({ size: 'small' }),\n\t\t\t\t\n\t\t\t\tnew TouchBarLabel({\n\t\t\t\t\t\n\t\t\t\t\tlabel: i18n.t('touchbar:prefs.theme', 'Theme')\n\t\t\t\t}),\n\t\t\t\t\n\t\t\t\tthemeSelect,\n\t\t\t\t\n\t\t\t\tnew TouchBarSpacer({ size: 'small' }),\n\t\t\t\t\n\t\t\t\tnew TouchBarButton({\n\t\t\t\t\t\n\t\t\t\t\tlabel: i18n.t('touchbar:prefs.close', 'Close'),\n\t\t\t\t\taccessibilityLabel: i18n.t('touchbar:prefs.close', 'Close'),\n\t\t\t\t\tbackgroundColor: '#3479F6',\n\t\t\t\t\tclick: () => { app.emit( 'close-prefs' ) }\n\t\t\t\t})\n\t\t\t]\n\t\t})\n\t\t\n\t\twindow.setTouchBar( prefsBar )\n\t}\n}\n\n\nipcMain.on('update-textslider-touchbar', (event, message) => {\n\t\n\ttextSlider.value = message\n})\n\n\nipcMain.on('update-themeselect-touchbar', (event, message) => {\n\t\n\tlet index = themeVals.indexOf( message )\n\tthemeSelect.selectedIndex = index\n})\n"],"file":"../touchbar.min.js"}